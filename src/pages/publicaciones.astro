---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";
import { Icon } from "astro-icon/components";
import { format } from "@formkit/tempo";

const PUBLICACIONES = (await getCollection("publicaciones")).sort((a, b) =>
    new Date(a.data.published_date) < new Date(b.data.published_date) ? 1 : -1,
);
---

<Layout title="Otras publicaciones">
    <div class="flex flex-col gap-4 mb-24">
        {
            PUBLICACIONES.map(({ data: pub }) => (
                <article class="border border-stone-200 bg-white rounded-md p-4 w-full flex flex-col-reverse md:flex-row gap-6 hover:shadow-sm transition-all">
                    <div class="flex flex-col w-full md:w-8/12">
                        <span class="text-xs text-stone-500 mb-3">
                            {format(pub.published_date, 'DD/MM/YYYY')}
                        </span>
                        <h3 class="font-black text-lg md:truncate md:line-clamp-2 md:text-wrap">
                            {pub.title}
                        </h3>
                        {pub.url && (
                            <a
                                href={pub.url}
                                target="_blank"
                                class="text-sm text-stone-600 mt-2 mb-3 flex items-center gap-2"
                            >
                                <Icon name="external-link" size={16} />
                                Visitar publicaciÃ³n
                            </a>
                        )}
                    </div>
                </article>
            ))
        }
    </div>
</Layout>
